{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/ASTRA/ASTRA-main/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport {cn} from '@/lib/utils';\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, React.ComponentProps<'textarea'>>(\n  ({className, ...props}, ref) => {\n    return (\n      <textarea\n        className={cn(\n          'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\nTextarea.displayName = 'Textarea';\n\nexport {Textarea};\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAEA,MAAM,yBAAW,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC9B,CAAC,EAAC,SAAS,EAAE,GAAG,OAAM,EAAE;IACtB,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,qTACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,SAAS,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["file:///home/user/ASTRA/ASTRA-main/src/ai/flows/legal-chatbot.ts"],"sourcesContent":["\n'use server';\n\n/**\n * @fileOverview A legal chatbot that can answer questions with multimodal context.\n *\n * - legalChatbot - A function that handles a chatbot conversation turn.\n * - LegalChatbotInput - The input type for the legalChatbot function.\n * - LegalChatbotOutput - The return type for the legalChatbot function.\n */\n\nimport {ai} from '@/ai/genkit';\nimport {z} from 'genkit';\n\nconst MessageSchema = z.object({\n    role: z.enum(['user', 'assistant', 'tool']),\n    content: z.string(),\n    filePreview: z.string().optional(),\n    fileName: z.string().optional(),\n    name: z.string().optional(), // For tool requests/responses\n});\n\nconst LegalChatbotInputSchema = z.object({\n  query: z.string().describe('The user\\'s current question or message.'),\n  jurisdiction: z.string().describe('The legal jurisdiction to consider for the response.'),\n  documentDataUri: z.string().optional().describe(\n    \"An optional document or image file provided by the user for context, as a data URI that must include a MIME type and use Base64 encoding. Expected format: 'data:<mimetype>;base64,<encoded_data>'.\"\n  ),\n  history: z.array(MessageSchema).describe('The history of the conversation so far.'),\n});\nexport type LegalChatbotInput = z.infer<typeof LegalChatbotInputSchema>;\n\nconst LegalChatbotOutputSchema = z.object({\n  response: z.string().describe('The AI\\'s response to the user\\'s query.'),\n});\nexport type LegalChatbotOutput = z.infer<typeof LegalChatbotOutputSchema>;\n\nexport async function legalChatbot(input: LegalChatbotInput): Promise<LegalChatbotOutput> {\n  const response = await legalChatbotFlow(input);\n  return { response };\n}\n\nconst prompt = ai.definePrompt({\n  name: 'legalChatbotPrompt',\n  input: {schema: LegalChatbotInputSchema},\n  prompt: `You are an expert attorney providing legal advice. Your goal is to give direct, actionable answers to the user's questions based on the provided context. Do not include disclaimers about not being a lawyer.\n\n  Your response must be tailored to the laws and regulations of the following jurisdiction: {{{jurisdiction}}}.\n  \n  Current time: ${new Date().toISOString()}\n\n  Conversation History:\n  {{#each history}}\n  {{#if name}}\n  Tool Response ({{name}}): {{content}}\n  {{else}}\n  {{role}}: {{content}}\n  {{/if}}\n  {{/each}}\n  \n  Current User Query: {{{query}}}\n  {{#if documentDataUri}}\n  The user has also provided the following file for context:\n  {{media url=documentDataUri}}\n  {{/if}}\n\n  Please provide a direct and clear legal response to the current user query, respecting the laws of {{{jurisdiction}}}.\n  `,\n});\n\nconst legalChatbotFlow = ai.defineFlow(\n  {\n    name: 'legalChatbotFlow',\n    inputSchema: LegalChatbotInputSchema,\n    outputSchema: z.string(),\n  },\n  async (input) => {\n    \n    const llmResponse = await prompt(input);\n    \n    return llmResponse.text;\n  }\n);\n"],"names":[],"mappings":";;;;;;IAqCsB,eAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["file:///home/user/ASTRA/ASTRA-main/src/components/ui/alert-dialog.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 175, "column": 0}, "map": {"version":3,"sources":["file:///home/user/ASTRA/ASTRA-main/src/app/dashboard/legal-chatbot/page.tsx"],"sourcesContent":["\n\"use client\";\n\nimport { Suspense } from 'react';\nimport { useState, useCallback, useRef, useEffect } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Loader2, Bot, User, Send, Paperclip, X, File as FileIcon } from 'lucide-react';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { legalChatbot, LegalChatbotInput } from '@/ai/flows/legal-chatbot';\nimport Image from 'next/image';\nimport { useSearchParams, useRouter } from 'next/navigation';\nimport {\n  createConversation,\n  addMessageToConversation,\n  uploadFile,\n  getConversation\n} from '@/lib/database';\nimport { auth } from '@/lib/firebase';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\"\n\n\ninterface Message {\n  role: 'user' | 'assistant';\n  content: string;\n  filePreview?: string; // For temporary local preview\n  fileUrl?: string; // For permanent storage\n  fileName?: string;\n}\n\ninterface Jurisdiction {\n  code: string;\n  name: string;\n}\n\nfunction LegalChatbot() {\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [input, setInput] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [file, setFile] = useState<File | null>(null);\n  const [filePreview, setFilePreview] = useState<string | null>(null);\n  const [jurisdiction, setJurisdiction] = useState<Jurisdiction | null>(null);\n  const [conversationId, setConversationId] = useState<string | null>(null);\n  const [showLoginPrompt, setShowLoginPrompt] = useState(false);\n\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const scrollAreaRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const conversationIdFromUrl = searchParams.get('id');\n    if (auth.currentUser && conversationIdFromUrl) {\n      loadConversation(conversationIdFromUrl);\n    } else {\n      setMessages([]);\n      setConversationId(null);\n    }\n\n    const storedJurisdiction = localStorage.getItem('jurisdiction');\n    if (storedJurisdiction) {\n      setJurisdiction(JSON.parse(storedJurisdiction));\n    }\n  }, [searchParams, router]);\n  \n  const loadConversation = async (id: string) => {\n      setIsLoading(true);\n      const conversation = await getConversation(id);\n      if (conversation && conversation.messages) {\n        setConversationId(conversation.id);\n        const formattedMessages = conversation.messages.map((msg: any) => ({\n          role: msg.sender === 'user' ? 'user' : 'assistant',\n          content: msg.content,\n          fileUrl: msg.fileUrl,\n          fileName: msg.fileName,\n        }));\n        setMessages(formattedMessages);\n      } else {\n        router.push('/dashboard/legal-chatbot');\n      }\n      setIsLoading(false);\n      scrollToBottom();\n    };\n\n\n  const onDrop = useCallback((acceptedFiles: File[]) => {\n    const uploadedFile = acceptedFiles[0];\n    if (uploadedFile) {\n      setFile(uploadedFile);\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setFilePreview(reader.result as string);\n      };\n      reader.readAsDataURL(uploadedFile);\n    }\n  }, []);\n\n  const { getRootProps, getInputProps, open } = useDropzone({\n    onDrop,\n    noClick: true,\n    noKeyboard: true,\n    accept: {\n      'image/*': ['.jpeg', '.png', '.gif', '.webp'],\n      'text/plain': ['.txt'],\n      'application/pdf': ['.pdf'],\n    },\n  });\n\n  const scrollToBottom = () => {\n    setTimeout(() => {\n      const scrollableViewport = (scrollAreaRef.current?.firstChild as HTMLElement)?.firstChild as HTMLElement;\n      if (scrollableViewport) {\n        scrollableViewport.scrollTop = scrollableViewport.scrollHeight;\n      }\n    }, 100);\n  };\n  \n  const handleAttachmentClick = () => {\n    if (!auth.currentUser) {\n      setShowLoginPrompt(true);\n    } else {\n      open();\n    }\n  };\n\n  const handleSendMessage = async () => {\n    if (!jurisdiction || (!input.trim() && !file)) return;\n\n    setIsLoading(true);\n    const query = input;\n    const tempFile = file;\n    const tempFilePreview = filePreview;\n\n    setInput('');\n    setFile(null);\n    setFilePreview(null);\n    \n     if (!auth.currentUser) {\n      const userMessageForUI: Message = { role: 'user', content: query };\n      setMessages(prev => [...prev, userMessageForUI]);\n      scrollToBottom();\n\n      const aiPayload: LegalChatbotInput = {\n        query,\n        history: messages,\n        jurisdiction: jurisdiction.name,\n      };\n      const result = await legalChatbot(aiPayload);\n      const aiMessage: Message = { role: 'assistant', content: result.response };\n      setMessages(prev => [...prev, aiMessage]);\n\n      setIsLoading(false);\n      scrollToBottom();\n      return;\n    }\n\n    const userMessageForUI: Message = {\n      role: 'user',\n      content: query,\n      ...(tempFilePreview && { filePreview: tempFilePreview, fileName: tempFile?.name || \"Uploaded File\" }),\n    };\n    setMessages(prev => [...prev, userMessageForUI]);\n    scrollToBottom();\n\n    let currentConversationId = conversationId;\n    \n    try {\n      let fileUrl: string | null = null;\n      let fileName: string | null = null;\n\n      if (tempFile) {\n        fileUrl = await uploadFile(tempFile);\n        fileName = tempFile.name;\n      }\n      \n      if (!currentConversationId) {\n        const newConvId = await createConversation(\n          query.substring(0, 30) || 'New Conversation',\n          { content: query, fileUrl, fileName }\n        );\n        currentConversationId = newConvId;\n        setConversationId(newConvId);\n        router.push(`/dashboard/legal-chatbot?id=${newConvId}`, { scroll: false });\n      } else {\n        await addMessageToConversation(currentConversationId, 'user', query, fileUrl, fileName);\n      }\n      \n      const aiPayload: LegalChatbotInput = {\n        query,\n        history: messages, \n        jurisdiction: jurisdiction.name,\n        ...(tempFilePreview && { documentDataUri: tempFilePreview }),\n      };\n\n      const result = await legalChatbot(aiPayload);\n      await addMessageToConversation(currentConversationId, 'ai', result.response);\n\n      const aiMessage: Message = { role: 'assistant', content: result.response };\n      setMessages(prev => [...prev, aiMessage]);\n\n    } catch (e) {\n      console.error(\"Error processing message:\", e);\n      const errorMessage: Message = { role: 'assistant', content: \"Sorry, I encountered an error. Please try again.\" };\n      setMessages(prev => [...prev, errorMessage]);\n    } finally {\n      setIsLoading(false);\n      scrollToBottom();\n    }\n  };\n  \n  const removeFile = () => {\n    setFile(null);\n    setFilePreview(null);\n  }\n\n  return (\n    <main className=\"flex flex-col h-full bg-secondary p-4 md:p-8\">\n      <Card className=\"w-full max-w-4xl mx-auto shadow-lg flex flex-col h-full\" {...getRootProps()}>\n        <CardHeader className=\"flex flex-row justify-between items-center\">\n          <CardTitle className=\"font-serif text-2xl flex items-center gap-3\">\n            <Bot className=\"h-6 w-6\" />\n            Legal Question Chatbot\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"flex-1 flex flex-col min-h-0\">\n          <ScrollArea className=\"flex-1 pr-4 -mr-4\" ref={scrollAreaRef}>\n            <div className=\"space-y-6\">\n              {messages.map((message, index) => (\n                <div key={index} className={`flex gap-3 ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}>\n                  {message.role === 'assistant' && <Bot className=\"h-6 w-6 text-primary flex-shrink-0\" />}\n                  <div className={`p-3 rounded-lg max-w-lg ${message.role === 'user' ? 'bg-primary text-primary-foreground' : 'bg-muted'}`}>\n                    {(message.filePreview || message.fileUrl) && (\n                        <div className=\"mb-2 p-2 border rounded-md bg-background/20\">\n                            {(message.filePreview || message.fileUrl || \"\").startsWith('data:image') || (message.fileUrl && (message.fileName?.endsWith('.png') || message.fileName?.endsWith('.jpg') || message.fileName?.endsWith('.jpeg')))? (\n                                <Image src={message.filePreview || message.fileUrl!} alt={message.fileName || \"Uploaded image\"} width={200} height={150} className=\"rounded-md object-cover\" />\n                            ) : (\n                                <a href={message.fileUrl} target=\"_blank\" rel=\"noopener noreferrer\" className=\"flex items-center gap-2 text-blue-500 hover:underline\">\n                                    <FileIcon className=\"h-6 w-6 flex-shrink-0\" />\n                                    <span className=\"text-sm font-medium\">{message.fileName}</span>\n                                </a>\n                            )}\n                        </div>\n                    )}\n                    <p className=\"text-sm whitespace-pre-wrap\">{message.content}</p>\n                  </div>\n                  {message.role === 'user' && <User className=\"h-6 w-6 text-muted-foreground flex-shrink-0\" />}\n                </div>\n              ))}\n              {isLoading && messages.length > 0 && messages[messages.length - 1]?.role === 'user' && (\n                <div className=\"flex justify-start\">\n                    <Bot className=\"h-6 w-6 text-primary flex-shrink-0\" />\n                    <div className=\"p-3 rounded-lg bg-muted flex items-center\">\n                        <Loader2 className=\"h-5 w-5 animate-spin\" />\n                    </div>\n                </div>\n              )}\n            </div>\n          </ScrollArea>\n          <div className=\"mt-4 pt-4 border-t\">\n             {filePreview && (\n                <div className=\"relative p-2 border rounded-lg flex items-center gap-3 mb-2\">\n                    {file?.type.startsWith('image/') ? (\n                        <Image src={filePreview} alt=\"Preview\" width={40} height={40} className=\"rounded-md object-cover\"/>\n                    ) : (\n                        <FileIcon className=\"h-6 w-6 text-muted-foreground\"/>\n                    )}\n                    <div className=\"text-sm flex-1\">\n                        <p className=\"font-medium truncate\">{file?.name}</p>\n                    </div>\n                    <Button variant=\"ghost\" size=\"icon\" className=\"h-6 w-6\" onClick={removeFile}>\n                        <X className=\"h-4 w-4\" />\n                    </Button>\n                </div>\n            )}\n            <div className=\"relative\">\n              <input {...getInputProps()} />\n              <Textarea\n                placeholder=\"Ask a legal question...\"\n                value={input}\n                onChange={(e) => setInput(e.target.value)}\n                onKeyDown={(e) => {\n                  if (e.key === 'Enter' && !e.shiftKey) {\n                    e.preventDefault();\n                    handleSendMessage();\n                  }\n                }}\n                className=\"pr-24 text-base\"\n                rows={2}\n              />\n              <div className=\"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1\">\n                 <Button variant=\"ghost\" size=\"icon\" onClick={handleAttachmentClick}>\n                    <Paperclip className=\"h-5 w-5\" />\n                </Button>\n                <Button\n                    size=\"icon\"\n                    onClick={handleSendMessage}\n                    disabled={isLoading || (!input.trim() && !file) || !jurisdiction}\n                >\n                    <Send className=\"h-5 w-5\" />\n                </Button>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n      <AlertDialog open={showLoginPrompt} onOpenChange={setShowLoginPrompt}>\n        <AlertDialogContent>\n            <AlertDialogHeader>\n            <AlertDialogTitle>Authentication Required</AlertDialogTitle>\n            <AlertDialogDescription>\n                You need to be logged in to upload and analyze documents. Please log in to continue.\n            </AlertDialogDescription>\n            </AlertDialogHeader>\n            <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction onClick={() => router.push('/login')}>Login</AlertDialogAction>\n            </AlertDialogFooter>\n        </AlertDialogContent>\n     </AlertDialog>\n    </main>\n  );\n}\n\n\nexport default function LegalChatbotPage() {\n  return (\n    <Suspense>\n      <LegalChatbot />\n    </Suspense>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}